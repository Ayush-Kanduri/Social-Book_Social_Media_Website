<li id="post-<%= post._id %>">
	<p>
		<!-- If (User is signed in) -->
		<!-- If (User who is signed in == User who created the post) -->
		<!-- locals.user.id is String -->
		<!-- post.user.id is String, post.user._id is Object-Id -->
		<% if((locals.user) && (locals.user.id == post.user.id)){ %>
		<small>
			<!-- post.id is String by MongoDB, post._id is Number -->
			<a class="delete-post-button" href="/posts/delete/<%= post.id %>">X</a>
		</small>
		<% } %> <%= post.content %>
		<br />
		<small><%= post.user.name %></small>
	</p>
	<div class="post-comments">
		<% if(locals.user){ %>
		<form action="/comments/create" method="post">
			<textarea
				name="content"
				cols="20"
				rows="3"
				placeholder="Type Here To Add Comment ..."
			></textarea>
			<!-- Send ID of this specific Post where the Comment would be added  -->
			<input type="hidden" name="post" value="<%= post._id %>" />
			<input type="submit" value="Add Comment" />
		</form>
		<% } %>
		<div class="post-comments-list">
			<ul id="post-comments-<%= post._id %>">
				<% for(comment of post.comments){ %> <%- include('_comment') -%> <%
				} %>
			</ul>
		</div>
	</div>
</li>



//Export the Posts Controller's create() Function
module.exports.create = async (req, res) => {
	try {
		await Post.create({
			content: req.body.content,
			//We have Already Set the Authenticated User in the Request Object
			user: req.user._id,
		});
		
		req.flash("success", "Post published !!!");
		return res.redirect("back");
	} catch (err) {
		req.flash("error", err);
		return res.redirect("back");
	}
};




//Export the Home Controller's Home() Function to the "/" Route.
module.exports.home = async (request, response) => {
	//Populate the User (from user field) of each Post, Comments from comments array and the User making the comment from the Comment Schema.
	try {
		let posts = await Post.find({})
			.populate("user")
			.populate({
				path: "comments",
				populate: {
					path: "user",
				},
			});

		let users = await User.find({});

		return response.render("home", {
			title: "Home Page",
			posts: posts,
			all_users: users,
		});
	} catch (err) {
		console.log("Error: ", err);
		return;
	}
};




//Export the Posts Controller's destroy() Function
module.exports.destroy = async (req, res) => {
	try {
		let post = await Post.findById(req.params.id);

		//.id means converting the object id into string
		//If the User who posted the post == the User logged in
		//Object value == String value TRUE, Object value === String value FALSE
		//post.user is an Object with the User's Object ID
		//req.params.id is String, req.user.id is String, req.user._id is Object-Id
		if (post.user == req.user.id) {
			//Delete the Post
			post.remove();
			console.log("Post Deleted");
			await Comment.deleteMany({ post: req.params.id });
			req.flash("success", "Post deleted !!!");
			return res.redirect("back");
		} else {
			req.flash("err", "Post cannot be deleted !!!");
			return res.redirect("back");
		}
	} catch (err) {
		req.flash("error", err);
		return;
	}
};